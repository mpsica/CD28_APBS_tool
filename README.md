# CD28_APBS_tool
### Tool to calculate Difference between APBS maps 


[![DOI](https://zenodo.org/badge/431962403.svg)](https://zenodo.org/badge/latestdoi/431962403)


----------------------

**Soft requirements:**
- Bash
- R (Special libraries: none)
- APBS (1), available in: https://github.com/Electrostatics/apbs. In Linux (Ubuntu) APBS can be installed from repositories. Type in terminal:
	
		sudo apt install apbs
	
- PDB2PQR, available in: https://pdb2pqr.readthedocs.io/en/latest/getting.html

(1) Adaptive Poisson-Boltzmann Solver are calculated  using the *apbs* tool developed in:
*Baker NA, Sept D, Joseph S, Holst MJ, McCammon JA. Electrostatics of nanosystems: application to microtubules and the ribosome. Proc. Natl. Acad. Sci. USA 98, 10037-10041 2001.*

-----------------------
We provide two scripts: *Delta_q_script.sh* and *_func.R*. With these scripts we calculated the difference between to maps generated by APBS. APBS requieres the structure to be formated as PQR. PDB2PQR is the tool for this conversion. *Delta_q_script.sh* is a wrapper script that performs these two steps and then parse the maps to *_func.R* to perform the final calculation.

To begin, using the same imput PDB structure, the script first calcultes two APBS maps at two different pH values (5 and 7, but *Delta_q_script.sh* can be edited to change any of these values). The maps produced by APBS (*.dx* files) are 3D matrices, so to calculate the difference between maps a simple script in R (*_func.R*) calcultes an element-wise subtraction. For that reason it is important that APBS maps at both pHs are calculated over the same input structure. The substracton is calculated as ***map_at_pH7*** minus ***map_at_pH5*** so positive difference (Delta_q > 0) means an increase in positive charge (or decrease in negative charge).

Remember to give execution permission to these scripts.

-----------------------

Instructions:

1) Load the pdb structures in the current working directory (CD28.pdb is provided with this repo) together with *Delta_q_script.sh* and *_func.R*.

2) Run the script as ([protein]=CD28 in our case): 

		./Delta_q_script.sh [protein].pdb

3) The output file (*Delta_q-[protein].dx*) will be created in the same directory.

4) To observe the maps in 3D around the protein in Pymol (as in Fig. 6A&B), the *Delta_q-[protein].dx* can be loaded together with the input PDB file. Also VMD or Chimera can be used. 


